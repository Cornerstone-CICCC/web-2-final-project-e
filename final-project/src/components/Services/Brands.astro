---
import Button from "../Button/Button.astro";
import { Image } from "astro:assets";
import KIA from "../../assets/svgs/services_brand_1.svg";
import BMW from "../../assets/svgs/services_brand_2.svg";
import BENZ from "../../assets/svgs/services_brand_3.svg";
import HUNDAI from "../../assets/svgs/services_brand_4.svg";
import HONDA from "../../assets/svgs/services_brand_5.svg";
import ACURA from "../../assets/svgs/services_brand_6.svg";
import FORD from "../../assets/svgs/services_brand_7.svg";

const BRAND_LIST = [
  { id: 1, name: "KIA", logo: KIA },
  { id: 2, name: "BMW", logo: BMW },
  { id: 3, name: "BENZ", logo: BENZ },
  { id: 4, name: "HUNDAI", logo: HUNDAI },
  { id: 5, name: "HONDA", logo: HONDA },
  { id: 6, name: "ACURA", logo: ACURA },
  { id: 7, name: "FORD", logo: FORD },
  { id: 8, name: "HUNDAI", logo: HUNDAI },
  { id: 9, name: "KIA", logo: KIA },
  { id: 10, name: "BENZ", logo: BENZ },
  { id: 11, name: "FORD", logo: FORD },
];
---

<section class="brands">
  <div class="container narrow brands__container">
    <span class="text-medium-bold">We work on</span>
    <h4>All Makes & Models</h4>

    <ul class="brands__list" id="brands-list">
      {
        BRAND_LIST.map((b) => (
          <li class="brands__item">
            <Image class="brands__logo" src={b.logo} alt={`${b.name} logo`} />
          </li>
        ))
      }
    </ul>

    <div class="brand__button">
      <Button
        id="view-more-btn"
        variant="line"
        label="View more"
        isFullWidth={true}
      />
    </div>
  </div>
</section>

<style>
  .brands__container {
    display: flex;
    align-items: center;
    flex-direction: column;
    gap: 24px;
  }

  .brands__list {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 48px;
    flex-wrap: wrap;
    max-width: 988px;
  }

  .brands__item {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .brands__logo {
    width: 100px;
    height: auto;
    object-fit: contain;
  }

  .brand__button {
    display: none;
  }

  @media (max-width: 768px) {
    .brands {
      padding: 40px 0;
    }

    .brands__list {
      flex-direction: column;
      gap: 32px;
    }

    .brand__button {
      display: flex;
      width: 100%;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const list = document.getElementById("brands-list");
    const button = document.getElementById("view-more-btn");
    if (!list || !button) return;

    const items = Array.from(list.children);
    let visibleCount = 4;

    const updateVisibility = () => {
      items.forEach((item, index) => {
        item.style.display = index < visibleCount ? "flex" : "none";
      });
      if (visibleCount >= items.length) {
        button.style.display = "none";
      }
    };

    updateVisibility();

    button.addEventListener("click", () => {
      visibleCount += 4;
      updateVisibility();
    });

    const handleResize = () => {
      if (window.innerWidth > 768) {
        items.forEach((item) => (item.style.display = "flex"));
        button.style.display = "none";
      } else {
        updateVisibility();
      }
    };

    window.addEventListener("resize", handleResize);
  });
</script>
